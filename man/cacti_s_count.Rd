% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step_s_count.R
\name{cacti_s_count}
\alias{cacti_s_count}
\title{Count reads in genomic segments (CACTI-S)}
\usage{
cacti_s_count(
  file_bams,
  file_saf,
  file_counts_out,
  threads = 1,
  isPairedEnd = FALSE,
  ...
)
}
\arguments{
\item{file_bams}{Character vector of BAM file paths.}

\item{file_saf}{Path to the SAF annotation file (from \code{cacti_s_create_segments}).}

\item{file_counts_out}{Output path for the counts matrix.}

\item{threads}{Number of threads for featureCounts.}

\item{isPairedEnd}{Logical. If \code{TRUE}, fragments are counted instead of reads.
Default is \code{FALSE}.}

\item{...}{Additional arguments passed to \code{Rsubread::featureCounts}.}
}
\value{
Invisibly returns the counts matrix; writes \code{file_counts_out}.
}
\description{
A wrapper around \code{Rsubread::featureCounts} to quantify reads in the SAF segments
generated by \code{cacti_s_create_segments}.
}
\details{
By default, this runs with settings optimized for CACTI-S:
\itemize{
\item \code{-F SAF}: Uses the SAF format provided.
\item \code{--read2pos 5}: Reduces reads to their 5' end.
\item \code{--primary}: Counts only primary alignments.
\item \code{--ignoreDup}: Ignores duplicate reads.
}
}
\examples{
\dontrun{
# Locate test data bundled in the package
file_saf <- system.file("extdata/test_results", "test_segments.saf", package = "cacti")
file_bam1 <- system.file("extdata", "Sample1.bam", package = "cacti")
file_bam2 <- system.file("extdata", "Sample2.bam", package = "cacti")
file_bam3 <- system.file("extdata", "Sample3.bam", package = "cacti")
file_bam4 <- system.file("extdata", "Sample4.bam", package = "cacti")

# Define output file
file_out <- "inst/extdata/test_results/test_raw_counts.txt"

# Run counting
if (file.exists(file_bam1) && file.exists(file_saf)) {
  cacti_s_count(
    file_bams = c(file_bam1, file_bam2, file_bam3, file_bam4),
    file_saf  = file_saf,
    file_counts_out = file_out
  )

  # Check result
  head(read.table(file_out, header = TRUE))
}
}
}
