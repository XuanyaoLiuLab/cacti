[{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"CACTI peak-window pipeline","text":"cacti package implements CACTI peak-window method chromatin QTL mapping. designed : group nearby peaks non-overlapping windows, residualize peak intensities respect covariates, test association genetic variants multi-peak windows using principal-component omnibus (PCO) test, optionally aggregate per-chromosome results compute window-level FDR. vignette explains: overall workflow. expected input file formats. output files produced pipeline. Example usage bundled toy data inst/extdata/. main user-facing functions vignette : cacti_run_chr() – run full CACTI peak-window pipeline one chromosome, cacti_run_genome() – run pipeline across multiple chromosomes add FDR. Lower-level building blocks :","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"part-1-overview-of-the-peak-window-pipeline","dir":"Articles","previous_headings":"","what":"Part 1: Overview of the peak-window pipeline","title":"CACTI peak-window pipeline","text":"CACTI peak-window pipeline three main steps: Using genomic coordinates (chromosome, start, end) peaks, Divide genome fixed-size windows (e.g. 50 kb), Assign peaks windows create window (group) table. Input: peak intensity matrix (features x samples) covariate matrix (covariates x samples), Fit linear models peak ~ covariates, Save residualized intensity values format original matrix, one inputs association test. Input: cis-QTL summary statistics z peak–SNP pairs, peak windows, residualized phenotype, construct Z-score matrix (variants x peaks), compute PCO-based multi-peak p-value number peaks ≥ min_peaks, otherwise fall back univariate p-value, Output: one p-value file per chromosome, one row per (group, snp) pair. Across chromosomes, cacti_add_fdr() (used cacti_run_genome()) aggregates p-values computes q-values top hit per window.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"part-2-input-file-formats","dir":"Articles","previous_headings":"","what":"Part 2: Input file formats","title":"CACTI peak-window pipeline","text":"section describes expected columns layout input file type. also inspect toy dataset bundled package :","code":"inst/extdata/   test_pheno_meta.bed   test_pheno.txt   test_covariates.txt   test_qtl_sum_stats_chr5.txt.gz"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"peak-metadata-pheno-meta-bed-like","dir":"Articles","previous_headings":"Part 2: Input file formats","what":"1. Peak metadata (pheno meta / BED-like)","title":"CACTI peak-window pipeline","text":"peak metadata file describes genomic coordinates IDs peaks. Used : cacti_group_peak_window(), cacti_run_chr(), cacti_run_genome() Argument: file_pheno_meta Example file: test_pheno_meta.bed Required columns: phe_chr – chromosome name, typically \"chr\" prefix (e.g. \"chr5\"), phe_from – peak start position (integer; must < phe_to), phe_to – peak end position (integer), phe_id – unique peak identifier.","code":"library(cacti)  file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  head(data.table::fread(file_pheno_meta)) #>                phe_id phe_chr phe_from phe_to #>                <char>  <char>    <int>  <int> #> 1:   chr5_11429_11873    chr5    11429  11873 #> 2: chr5_217285_220962    chr5   217285 220962 #> 3: chr5_223012_223844    chr5   223012 223844 #> 4: chr5_270610_273325    chr5   270610 273325 #> 5: chr5_320783_323201    chr5   320783 323201 #> 6: chr5_343419_345060    chr5   343419 345060"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"phenotype-matrix-peak-intensity","dir":"Articles","previous_headings":"Part 2: Input file formats","what":"2. Phenotype matrix (peak intensity)","title":"CACTI peak-window pipeline","text":"phenotype matrix contains peak intensities (quantitative trait values). Used : cacti_pheno_cov_residual(), cacti_run_chr(), cacti_run_genome() Argument: file_pheno Example file: test_pheno.txt Layout: Rows = features (peaks). First column = feature ID (matching phe_id metadata). Remaining columns = samples.","code":"file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  head(data.table::fread(file_pheno))[, 1:5] #>                        ID       AF04      AF06       AF08      AF12 #>                    <char>      <num>     <num>      <num>     <num> #> 1: chr5_10248638_10251938  6.1639272 6.5171965  6.0122366 6.0046710 #> 2: chr5_10264481_10265888  0.2981699 0.2977740  2.0098907 0.4789852 #> 3: chr5_10265755_10268539  1.6214124 2.1306168  3.1048357 0.7830301 #> 4: chr5_10307340_10308285  0.7222144 0.8835924  0.2871122 0.5861384 #> 5: chr5_10311409_10312352  0.0350794 1.3397306 -0.2311209 0.3488682 #> 6: chr5_10333519_10334110 -0.1660226 0.8808080  0.5575939 1.1806155"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"covariate-matrix","dir":"Articles","previous_headings":"Part 2: Input file formats","what":"3. Covariate matrix","title":"CACTI peak-window pipeline","text":"covariate matrix encodes covariates sample (e.g. PCs, batch, sex, etc.). Used : cacti_pheno_cov_residual(), cacti_run_chr(), cacti_run_genome() Argument: file_cov Example file: test_covariates.txt Layout: Rows = covariates. First column = covariate ID. Remaining columns = samples.","code":"file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  head(data.table::fread(file_cov))[, 1:5] #>        ID       AF04       AF06       AF08       AF12 #>    <char>      <num>      <num>      <num>      <num> #> 1:   cov1 -0.1696051 -0.2304933 -0.2132352 -0.2220646"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"qtl-summary-statistics","dir":"Articles","previous_headings":"Part 2: Input file formats","what":"4. QTL summary statistics","title":"CACTI peak-window pipeline","text":"cis-QTL summary stats file contains association summary statistics peak–SNP pairs. Used : cacti_cal_p(), cacti_run_chr(), cacti_run_genome() Argument: qtl_file (per chromosome) qtl_files (multiple chromosomes, given vector/template) Example file: test_qtl_sum_stats_chr5.txt.gz Required columns: phe_id – peak ID (matching phe_id metadata ID phenotype matrix), var_id – variant ID, z – z-score association variant peak.","code":"qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  head(data.table::fread(qtl_file)) #>              phe_id      var_id         z #>              <char>      <char>     <num> #> 1: chr5_11429_11873 5_12041_T_A 0.2715305 #> 2: chr5_11429_11873 5_12114_G_C 0.1525914 #> 3: chr5_11429_11873 5_12225_A_G 1.0831622 #> 4: chr5_11429_11873 5_13018_A_C 0.9401877 #> 5: chr5_11429_11873 5_13114_C_G 0.9401877 #> 6: chr5_11429_11873 5_13125_T_G 0.9401877"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"part-3-output-files-from-cacti_run_chr","dir":"Articles","previous_headings":"","what":"Part 3: Output files from cacti_run_chr()","title":"CACTI peak-window pipeline","text":"cacti_run_chr() main function running CACTI peak-window pipeline single chromosome.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"overview","dir":"Articles","previous_headings":"Part 3: Output files from cacti_run_chr()","what":"1. Overview","title":"CACTI peak-window pipeline","text":"Calling: : Construct peak windows chromosomes (using window_size). Residualize phenotype matrix. Run CACTI association test specified chromosome (chr). returns named list output paths, writes following files:","code":"res_single_chr <- cacti_run_chr(   window_size     = \"50kb\",   file_pheno_meta = <peak metadata>,   file_pheno      = <phenotype matrix>,   file_cov        = <covariate matrix>,   chr             = \"chr5\",   qtl_file        = <QTL summary stats for chr5>,   out_prefix      = <output prefix>,   min_peaks       = 2 )"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"window-level-grouping-file","dir":"Articles","previous_headings":"Part 3: Output files from cacti_run_chr()","what":"2. Window-level grouping file","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_peak_group Produced : cacti_group_peak_window() Columns: group – window (group) ID (e.g. \"G1\", \"G2\", …), group_chr – chromosome window, group_from – window start position, group_to – window end position, pid_group – semicolon-separated list peak IDs window, n_pid_group – number peaks window.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"peak-level-grouping-file","dir":"Articles","previous_headings":"Part 3: Output files from cacti_run_chr()","what":"3. Peak-level grouping file","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_peak_group_peaklevel Columns: phe_id – peak ID, phe_chr – chromosome, phe_from, phe_to – peak start/end, group – window ID peak belongs, n_pid_group – number peaks window.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"residualized-phenotype-matrix","dir":"Articles","previous_headings":"Part 3: Output files from cacti_run_chr()","what":"4. Residualized phenotype matrix","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_pheno_cov_residual layout input phenotype matrix: Rows = features (peak IDs), First column = ID (peak IDs), Remaining columns = residualized values sample.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"per-window-p-value-file-for-the-chromosome","dir":"Articles","previous_headings":"Part 3: Output files from cacti_run_chr()","what":"5. Per-window p-value file for the chromosome","title":"CACTI peak-window pipeline","text":"Path: res_single_chr$file_p_peak_group row corresponds (group, snp) pair: group – window ID, snp – variant ID, windows ≥ min_peaks peaks, PCO-based multi-peak p-value. single-peak windows, univariate p-value derived z.","code":""},{"path":[]},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"per-chromosome-example-cacti_run_chr","dir":"Articles","previous_headings":"Part 4: Examples","what":"1. Per-chromosome example: cacti_run_chr()","title":"CACTI peak-window pipeline","text":"example running full pipeline toy chr5 data included inst/extdata/.","code":"library(cacti)  file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  # Use a temporary prefix to avoid cluttering the working directory out_prefix <- tempfile(\"cacti_chr5_\")  res_single_chr <- cacti_run_chr(   window_size     = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno      = file_pheno,   file_cov        = file_cov,   chr             = \"chr5\",   qtl_file        = qtl_file,   out_prefix      = out_prefix,   min_peaks       = 2 ) #> ======================================================= #>  CACTI Pipeline #> ======================================================= #> Output Directory: /tmp/RtmpEpmGBp #>  #> [Step 1/3] Group peaks into non-overlapping windows … #>  #> [Step 2/3] Residualize phenotype by covariates … #>  #> [Step 3/3] Run pvalue for chr5 … #>  #> ======================================================= #>  #>  CACTI pipeline for chr5 completed! #> ======================================================= #> ======================================================= #> ----------- Run summary ----------- #> Chromosome:chr5 #> Window size:50kb #>  #>  ----------- Input files ----------- #> Peaks BED:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_pheno_meta.bed #> Phenotype:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_pheno.txt #> Covariate:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_covariates.txt #> QTL summary stats:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_qtl_sum_stats_chr5.txt.gz #>  #>  ----------- Output files ----------- #>   [1] Grouped peak: /tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_peak_group_window50kb.txt #>   [2] Grouped peak (peak as row):/tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_peak_group_window50kb_peak_as_row.txt #>   [3] Residual phenotype:/tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_pheno_cov_residual.txt #>   [4] Pval results (chr5): /tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_pval_window50kb_chr5.txt.gz #> =======================================================  res_single_chr #> $file_peak_group #> [1] \"/tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_peak_group_window50kb.txt\" #>  #> $file_peak_group_peaklevel #> [1] \"/tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_peak_group_window50kb_peak_as_row.txt\" #>  #> $file_pheno_cov_residual #> [1] \"/tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_pheno_cov_residual.txt\" #>  #> $file_p_peak_group #> [1] \"/tmp/RtmpEpmGBp/cacti_chr5_39264c2f9c6d51_pval_window50kb_chr5.txt.gz\""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"genome-wide-wrapper-cacti_run_genome","dir":"Articles","previous_headings":"Part 4: Examples","what":"2. Genome-wide wrapper: cacti_run_genome()","title":"CACTI peak-window pipeline","text":"cacti_run_genome() provides convenience wrapper running pipeline across multiple chromosomes, aggregating p-values adding FDR via cacti_add_fdr(). Conceptually, : Loops chrs calls cacti_run_chr() one. Collects per-chromosome p-value files. Calls cacti_add_fdr() compute window-level q-values across windows chromosomes. simplest usage one QTL file per chromosome pass either: character vector qtl_files one path per chromosome, template \"{chr}\" placeholder, e.g. \"extdata/test_qtl_sum_stats_{chr}.txt.gz\". toy example, use data chr5, still demonstrates call function.","code":"file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  out_prefix <- tempfile(\"cacti_genome_\")  res_genome <- cacti_run_genome(   window_size     = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno      = file_pheno,   file_cov        = file_cov,   chrs            = \"chr5\",                 # toy example: one chromosome   qtl_files       = qtl_file,   out_prefix      = out_prefix,   file_fdr_out    = file.path(tempdir(), \"cacti_fdr_chr5.txt.gz\") ) #> ======================================================= #>  CACTI Pipeline Genome-Wide #> ======================================================= #> Output Directory: /tmp/RtmpEpmGBp #> -------------------------------------------------------- #> === [I/III] Running CACTI peak-window pipeline genome-wide === #> -------------------------------------------------------- #>  #> [Step 1/3] Group peaks into non-overlapping windows … #>  #> [Step 2/3] Residualize phenotype by covariates … #>  #> [Step 3/3] Run pvalue for chr5 … #>  #>  pipeline for chr5 completed! #>  #>  ----------- Input files ----------- #> Peaks BED:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_pheno_meta.bed #> Phenotype:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_pheno.txt #> Covariate:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_covariates.txt #> QTL summary stats:/tmp/Rtmp3Gr0m6/temp_libpath38fcd93ba5e3b2/cacti/extdata/test_qtl_sum_stats_chr5.txt.gz #>  #>  ----------- Output files ----------- #>   [1] Grouped peak: /tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_peak_group_window50kb.txt #>   [2] Grouped peak (peak as row):/tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_peak_group_window50kb_peak_as_row.txt #>   [3] Residual phenotype:/tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_pheno_cov_residual.txt #>   [4] Pval results (chr5): /tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_pval_window50kb_chr5.txt.gz #> -------------------------------------------------------- #>  #> === [II/III] Adding FDR across windows and chromosomes === #> -------------------------------------------------------- #> -------------------------------------------------------- #>  #> === [III/III] Genome-wide CACTI peak-window pipeline completed with FDR! === #> -------------------------------------------------------- #> ----------- Run summary ----------- #>   [1] Pvalue output: /tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_pval_window50kb_chr5.txt.gz #>   [2] FDR output: /tmp/RtmpEpmGBp/cacti_fdr_chr5.txt.gz  res_genome #> $file_peak_group #> [1] \"/tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_peak_group_window50kb.txt\" #>  #> $file_peak_group_peaklevel #> [1] \"/tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_peak_group_window50kb_peak_as_row.txt\" #>  #> $file_pheno_cov_residual #> [1] \"/tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_pheno_cov_residual.txt\" #>  #> $file_p_peak_group #> [1] \"/tmp/RtmpEpmGBp/cacti_genome_39264c5c3513dd_pval_window50kb_chr5.txt.gz\" #>  #> $file_fdr_out #> [1] \"/tmp/RtmpEpmGBp/cacti_fdr_chr5.txt.gz\""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_peak_window.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"CACTI peak-window pipeline","text":"vignette, : described CACTI peak-window pipeline, documented expected input file formats peak metadata, phenotypes, covariates, QTL summary statistics, explained main output files produced cacti_run_chr(), demonstrated run pipeline per-chromosome genome-wide using bundled toy data inst/extdata/. details step, see function reference: ?cacti_group_peak_window ?cacti_pheno_cov_residual ?cacti_cal_p ?cacti_add_fdr ?cacti_run_chr ?cacti_run_genome","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"CACTI-S: segment-based data preparation & mapping","text":"CACTI-S (Segment-based) pipeline designed process raw sequencing data (BAM files) normalized phenotype matrices QTL mapping. handles multi-step pipeline: Segmentation: Tile genome fixed-size segments (e.g., 1kb, 5kb). Reads counting: Count reads raw BAM files segments. Preprocessing: Perform quality control normalization. Mapping: Run cis-QTL mapping segments using MatrixEQTL generate summary statistics required multivariate CACTI model. vignette explains: overall workflow. expected input files. output files produced pipeline. Example usage bundled toy data inst/extdata/. main user-facing function vignette : cacti_s_prep() — master wrapper automates entire workflow BAM files summary statistics. Lower-level building blocks :","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"part-1-overview-of-the-cacti-s-pipeline","dir":"Articles","previous_headings":"","what":"Part 1: Overview of the CACTI-S pipeline","title":"CACTI-S: segment-based data preparation & mapping","text":"CACTI-S pipeline three main steps: Define quantify genomic segments Segmentation: Tiling genome fixed-size segments (e.g., 1kb, 5kb) using custom BED file. Quantification: Counting reads segments every sample (BAM file) using Rsubread. Output: raw counts matrix (Rows = Segments, Columns = Samples). Preprocess normalize phenotypes QC & Filtering & Normalization Output: normalized phenotype matrix ready QTL mapping. Cis-QTLs mapping Input: Normalized phenotype matrix, genotype data (VCF), covariates. Process: Runs `MatrixEQTL every variant–segment pair within defined cis window (e.g., 100kb). Output: Cis-QTL summary statistics (Z-scores), serve primary input CACTI multivariate test.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"part-2-quick-start","dir":"Articles","previous_headings":"","what":"Part 2: Quick start","title":"CACTI-S: segment-based data preparation & mapping","text":"users, cacti_s_prep() function convenient way run pipeline. automates steps manages intermediate files.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"locate-test-data","dir":"Articles","previous_headings":"Part 2: Quick start","what":"1. Locate test data","title":"CACTI-S: segment-based data preparation & mapping","text":"use small test files bundled cacti package. real analysis, actual BAM VCF paths.","code":"# Locate the 4 test BAM files bam_files <- list.files(   system.file(\"extdata\", package = \"cacti\"),   pattern = \"Sample.*\\\\.bam$\",   full.names = TRUE )  # Locate Genotype (VCF), Covariate, and Peak files file_vcf   <- system.file(\"extdata\", \"test_geno.vcf\", package = \"cacti\") file_cov   <- system.file(\"extdata\", \"test_cov.txt\", package = \"cacti\")  print(basename(c(bam_files, file_vcf, file_cov))) #> [1] \"Sample1.bam\"   \"Sample2.bam\"   \"Sample3.bam\"   \"Sample4.bam\"   #> [5] \"test_geno.vcf\" \"test_cov.txt\""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"run-the-pipeline","dir":"Articles","previous_headings":"Part 2: Quick start","what":"2. Run the pipeline","title":"CACTI-S: segment-based data preparation & mapping","text":"run pipeline following settings: Genome: hg19 Segment Size: 5kb Filter Mode: cpm_threshold (keep segments peak intensity CPM > 1 > 20% samples)","code":"res <- cacti_s_prep(   file_bams = bam_files,   file_vcf = file_vcf,   file_cov = file_cov,      out_dir = \"../inst/extdata/test_results\",   out_prefix = \"test\",    # Pipeline Parameters   genome = \"hg19\",   segment_size = \"5kb\",   filter_mode = \"cpm_threshold\",   min_cpm = 1,   min_prop = 0.2,    # Use 1 thread for this small demo   threads = 1 ) #> ======================================================= #>  CACTI-S Preparation Pipeline #> ======================================================= #> Output Directory: ../inst/extdata/test_results #> Input BAMs: 4 #>  #> [Step 1] Creating Genomic Segments... #> Using built-in chromosome sizes for: hg19 #> Generating 5kb segments for 22 autosomes (chr1-chr22)... #> Success! Created 576216 segments. Saved to: ../inst/extdata/test_results/test_segments.saf #>  #> [Step 2] Counting Reads... #> Counting reads for 4 BAM files... #> Settings: SAF format | Primary Only | Ignore Dups | Read2Pos = 5 #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.20.0 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           Sample1.bam                                      || #> ||                           Sample2.bam                                      || #> ||                           Sample3.bam                                      || #> ||                           Sample4.bam                                      || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : test_segments.saf (SAF)                          || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> ||     Multiple alignments : primary alignment only                           || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||        Duplicated Reads : ignored                                          || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file test_segments.saf ...                                 || #> ||    Features : 576216                                                       || #> ||    Meta-features : 576216                                                  || #> ||    Chromosomes/contigs : 22                                                || #> ||                                                                            || #> || Process BAM file Sample1.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 50                                                   || #> ||    Successfully assigned alignments : 50 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file Sample2.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 75                                                   || #> ||    Successfully assigned alignments : 75 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file Sample3.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 50                                                   || #> ||    Successfully assigned alignments : 50 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file Sample4.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 75                                                   || #> ||    Successfully assigned alignments : 75 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> Success! Counts written to: ../inst/extdata/test_results/test_raw_counts.txt #>  #> [Step 3] Preprocessing (QC, Filter, Normalize)... #> === Starting Preprocessing === #>   Input: ../inst/extdata/test_results/test_raw_counts.txt #>   Filter Mode: cpm_threshold #>   Cleaned sample names: Sample1, Sample2, Sample3... #>   Initial Features: 576216 #>   Initial Samples:  4 #>   Features after removing all-zeros: 2 #>   Filtering by intensity: CPM > 1 in > 20% samples #>   Features kept: 2 #>   Standardizing (Z-score per feature)... #>   Rank Normalizing (INT per sample)... #> Success! Processed data written to: ../inst/extdata/test_results/test_pheno_norm.txt #> Success! Processed data meta written to: ../inst/extdata/test_results/test_pheno_norm_meta.txt #>  #> [Step 4] Mapping Cis-QTLs... #> Preparing phenotype data... #>   Phenotype samples: 4 #> Converting VCF to genotype matrix... #> Preparing covariates... #> Rows read: 51 done. #> Rows read: 2 done. #> Rows read: 1 done. #> Running MatrixEQTL... #> Matching data files and location files #> 2 of 2 genes matched #> 51 of 51 SNPs matched #> Task finished in 0.003 seconds #> Processing covariates #> Task finished in 0.002 seconds #> Processing gene expression data (imputation, residualization) #> Task finished in 0.002 seconds #> Creating output file(s) #> Task finished in 0.006 seconds #> Performing eQTL analysis #> 100.00% done, 102 cis-eQTLs #> Task finished in 0.009 seconds #>  #> Success! Stats written to: ../inst/extdata/test_results/test_cis_qtl_stats.txt #> Mapping complete: ../inst/extdata/test_results/test_cis_qtl_stats.txt #>  #> ======================================================= #>  Pipeline Complete! #> ======================================================= #> Summary of Generated Files: #>   [1] Segments (SAF):      ../inst/extdata/test_results/test_segments.saf #>   [2] Raw Counts:          ../inst/extdata/test_results/test_raw_counts.txt #>   [3] Normalized Pheno:    ../inst/extdata/test_results/test_pheno_norm.txt #>   [4] Cis-QTL Stats:       ../inst/extdata/test_results/test_cis_qtl_stats.txt #> ======================================================="},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"explore-results","dir":"Articles","previous_headings":"Part 2: Quick start","what":"3. Explore results","title":"CACTI-S: segment-based data preparation & mapping","text":"function returns list paths generated files.","code":"print(res) #> $saf #> [1] \"../inst/extdata/test_results/test_segments.saf\" #>  #> $raw_counts #> [1] \"../inst/extdata/test_results/test_raw_counts.txt\" #>  #> $pheno #> [1] \"../inst/extdata/test_results/test_pheno_norm.txt\" #>  #> $qtl_stats #> [1] \"../inst/extdata/test_results/test_cis_qtl_stats.txt\""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"segments","dir":"Articles","previous_headings":"Part 2: Quick start > 3. Explore results","what":"Segments","title":"CACTI-S: segment-based data preparation & mapping","text":"file contains segment positions divide whole genome. Segment position (Top 5 Rows)","code":"saf <- read.table(res$saf, header = TRUE, nrows = 5) knitr::kable(saf, caption = \"Segment position (Top 5 Rows)\")"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"raw-counts","dir":"Articles","previous_headings":"Part 2: Quick start > 3. Explore results","what":"Raw counts","title":"CACTI-S: segment-based data preparation & mapping","text":"file contains raw counts within segments. Raw counts within segments (Top 5 Rows)","code":"raw_counts <- read.table(res$raw_counts, header = TRUE, nrows = 5) knitr::kable(raw_counts, caption = \"Raw counts within segments (Top 5 Rows)\")"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"normalized-phenotype-matrix","dir":"Articles","previous_headings":"Part 2: Quick start > 3. Explore results","what":"Normalized phenotype matrix","title":"CACTI-S: segment-based data preparation & mapping","text":"file contains filtered normalized data segments positions data, ready downstream analysis e.g. QTL mapping. Normalized phenotype matrix (Top Rows)","code":"pheno <- read.table(res$pheno, header = TRUE) knitr::kable(pheno, caption = \"Normalized phenotype matrix (Top Rows)\")"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"cis-qtl-summary-statistics","dir":"Articles","previous_headings":"Part 2: Quick start > 3. Explore results","what":"Cis-QTL summary statistics","title":"CACTI-S: segment-based data preparation & mapping","text":"file contains cis-QTL mapping associations individual segments. Cis-QTL summary statistics (Top 5 hits)","code":"if (!is.null(res$qtl_stats)) {   qtl <- read.table(res$qtl_stats, header = TRUE, nrows = 5)   knitr::kable(qtl, caption = \"Cis-QTL summary statistics (Top 5 hits)\") }"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"part-3-step-by-step-workflow","dir":"Articles","previous_headings":"","what":"Part 3: Step-by-step workflow","title":"CACTI-S: segment-based data preparation & mapping","text":"need control (e.g., inspecting intermediate files) customization, can run individual functions included whole pipeline separately.","code":""},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"step-1-create-segments","dir":"Articles","previous_headings":"Part 3: Step-by-step workflow","what":"Step 1: Create segments","title":"CACTI-S: segment-based data preparation & mapping","text":"First, generate SAF (Simplified Annotation Format) file defines genomic segments.","code":"file_saf <- \"../inst/extdata/test_results/test_segments.txt\"  cacti_s_create_segments(   file_saf_out = file_saf, # Output path for the SAF file.   genome = \"hg19\", # Genome build to use: \"hg19\" (default) or \"hg38\".   segment_size = \"5kb\" # Character like \"5kb\" or numeric bp (e.g. 5000). ) #> Using built-in chromosome sizes for: hg19 #> Generating 5kb segments for 22 autosomes (chr1-chr22)... #> Success! Created 576216 segments. Saved to: ../inst/extdata/test_results/test_segments.txt head(read.table(file_saf, header = TRUE)) #>             GeneID  Chr Start   End Strand #> 1      chr1_1_5000 chr1     1  5000      . #> 2  chr1_5001_10000 chr1  5001 10000      . #> 3 chr1_10001_15000 chr1 10001 15000      . #> 4 chr1_15001_20000 chr1 15001 20000      . #> 5 chr1_20001_25000 chr1 20001 25000      . #> 6 chr1_25001_30000 chr1 25001 30000      ."},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"step-2-count-reads","dir":"Articles","previous_headings":"Part 3: Step-by-step workflow","what":"Step 2: Count Reads","title":"CACTI-S: segment-based data preparation & mapping","text":"Next, quantify reads falling segments BAM files.","code":"file_counts <- \"../inst/extdata/test_results/test_raw_counts.txt\"  cacti_s_count(   file_bams = bam_files, # Character vector of BAM file paths.   file_saf = file_saf, # Path to the SAF annotation file (from \\code{cacti_s_create_segments}).   file_counts_out = file_counts, # Output path for the counts matrix.   threads = 1 # Number of threads for featureCounts. ) #> Counting reads for 4 BAM files... #> Settings: SAF format | Primary Only | Ignore Dups | Read2Pos = 5 #>  #>         ==========     _____ _    _ ____  _____  ______          _____   #>         =====         / ____| |  | |  _ \\|  __ \\|  ____|   /\\   |  __ \\  #>           =====      | (___ | |  | | |_) | |__) | |__     /  \\  | |  | | #>             ====      \\___ \\| |  | |  _ <|  _  /|  __|   / /\\ \\ | |  | | #>               ====    ____) | |__| | |_) | | \\ \\| |____ / ____ \\| |__| | #>         ==========   |_____/ \\____/|____/|_|  \\_\\______/_/    \\_\\_____/ #>        Rsubread 2.20.0 #>  #> //========================== featureCounts setting ===========================\\\\ #> ||                                                                            || #> ||             Input files : 4 BAM files                                      || #> ||                                                                            || #> ||                           Sample1.bam                                      || #> ||                           Sample2.bam                                      || #> ||                           Sample3.bam                                      || #> ||                           Sample4.bam                                      || #> ||                                                                            || #> ||              Paired-end : no                                               || #> ||        Count read pairs : no                                               || #> ||              Annotation : test_segments.txt (SAF)                          || #> ||      Dir for temp files : .                                                || #> ||                 Threads : 1                                                || #> ||                   Level : meta-feature level                               || #> ||      Multimapping reads : counted                                          || #> ||     Multiple alignments : primary alignment only                           || #> || Multi-overlapping reads : not counted                                      || #> ||   Min overlapping bases : 1                                                || #> ||          Read reduction : to 5' end                                        || #> ||        Duplicated Reads : ignored                                          || #> ||                                                                            || #> \\\\============================================================================// #>  #> //================================= Running ==================================\\\\ #> ||                                                                            || #> || Load annotation file test_segments.txt ...                                 || #> ||    Features : 576216                                                       || #> ||    Meta-features : 576216                                                  || #> ||    Chromosomes/contigs : 22                                                || #> ||                                                                            || #> || Process BAM file Sample1.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 50                                                   || #> ||    Successfully assigned alignments : 50 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file Sample2.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 75                                                   || #> ||    Successfully assigned alignments : 75 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file Sample3.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 50                                                   || #> ||    Successfully assigned alignments : 50 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Process BAM file Sample4.bam...                                            || #> ||    Single-end reads are included.                                          || #> ||    Total alignments : 75                                                   || #> ||    Successfully assigned alignments : 75 (100.0%)                          || #> ||    Running time : 0.00 minutes                                             || #> ||                                                                            || #> || Write the final count table.                                               || #> || Write the read assignment summary.                                         || #> ||                                                                            || #> \\\\============================================================================// #> Success! Counts written to: ../inst/extdata/test_results/test_raw_counts.txt head(read.table(file_counts, header = TRUE)) #>             GeneID  Chr Start   End Strand Length Sample1.bam Sample2.bam #> 1      chr1_1_5000 chr1     1  5000      .   5000          35          67 #> 2  chr1_5001_10000 chr1  5001 10000      .   5000          15           8 #> 3 chr1_10001_15000 chr1 10001 15000      .   5000           0           0 #> 4 chr1_15001_20000 chr1 15001 20000      .   5000           0           0 #> 5 chr1_20001_25000 chr1 20001 25000      .   5000           0           0 #> 6 chr1_25001_30000 chr1 25001 30000      .   5000           0           0 #>   Sample3.bam Sample4.bam #> 1          35          67 #> 2          15           8 #> 3           0           0 #> 4           0           0 #> 5           0           0 #> 6           0           0"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"step-3-preprocess","dir":"Articles","previous_headings":"Part 3: Step-by-step workflow","what":"Step 3: Preprocess","title":"CACTI-S: segment-based data preparation & mapping","text":"perform preprocessing steps count data, including - QC: Remove segments 0 reads samples. CPM: Transform counts log2(CPM + 0.5). match_overlap_count: Determines NN, number segments overlapping regions filter_bed. keeps top NN segments average intensity. prop: Keeps top prop_top proportion segments average intensity. Standardize: Z-score normalization per feature (Mean = 0, SD = 1). RankNorm: Inverse Normal Transform per sample.","code":"file_pheno <- \"../inst/extdata/test_results/test_pheno_norm.txt\" file_pheno_meta <- \"../inst/extdata/test_results/test_pheno_norm_meta.txt\"  cacti_s_preprocess(   file_raw_counts = file_counts, # Path to featureCounts output (from \\code{cacti_s_count}).   file_out = file_pheno, # Output path for the processed phenotype file.   file_out_meta = file_pheno_meta, # Output path for the meta file of processed phenotype.   filter_mode = \"cpm_threshold\", # Strategy to select segments: \"cpm_threshold\" (default).   min_cpm = 1, # (For \"cpm_threshold\") Minimum CPM threshold (default 1).   min_prop = 0.2 # (For \"cpm_threshold\") Minimum proportion of samples (default 0.2). ) #> === Starting Preprocessing === #>   Input: ../inst/extdata/test_results/test_raw_counts.txt #>   Filter Mode: cpm_threshold #>   Cleaned sample names: Sample1, Sample2, Sample3... #>   Initial Features: 576216 #>   Initial Samples:  4 #>   Features after removing all-zeros: 2 #>   Filtering by intensity: CPM > 1 in > 20% samples #>   Features kept: 2 #>   Standardizing (Z-score per feature)... #>   Rank Normalizing (INT per sample)... #> Success! Processed data written to: ../inst/extdata/test_results/test_pheno_norm.txt #> Success! Processed data meta written to: ../inst/extdata/test_results/test_pheno_norm_meta.txt head(read.table(file_pheno, header = TRUE)) #>            GeneID    Sample1    Sample2    Sample3    Sample4 #> 1     chr1_1_5000 -0.6744898  0.6744898 -0.6744898  0.6744898 #> 2 chr1_5001_10000  0.6744898 -0.6744898  0.6744898 -0.6744898 head(read.table(file_pheno_meta, header = TRUE)) #>            GeneID  Chr Start   End #> 1     chr1_1_5000 chr1     1  5000 #> 2 chr1_5001_10000 chr1  5001 10000"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"step-4-map-cis-qtls","dir":"Articles","previous_headings":"Part 3: Step-by-step workflow","what":"Step 4: Map Cis-QTLs","title":"CACTI-S: segment-based data preparation & mapping","text":"Finally, run cis-QTL mapping using normalized phenotype matrix using MatrixEQTL.","code":"file_qtl <- \"../inst/extdata/test_results/test_cis_qtl_stats.txt\"  cacti_s_map_cis(   file_pheno = file_pheno, # Path to the processed phenotype file (from `cacti_s_preprocess`).   file_pheno_meta = file_pheno_meta, # Path for the meta file of processed phenotype.   file_cov = file_cov, # Path to covariate matrix.   file_vcf = file_vcf, # Path to input VCF file.   file_qtl_out = file_qtl, # Output path for summary statistics.   cis_dist = 100000, # Cis-window distance (default 100000 bp = 100kb).   p_threshold = 1.0 # P-value threshold for output (default 1.0, print all associations). ) #> Preparing phenotype data... #>   Phenotype samples: 4 #> Converting VCF to genotype matrix... #> Preparing covariates... #> Rows read: 51 done. #> Rows read: 2 done. #> Rows read: 1 done. #> Running MatrixEQTL... #> Matching data files and location files #> 2 of 2 genes matched #> 51 of 51 SNPs matched #> Task finished in 0.002 seconds #> Processing covariates #> Task finished in 0.002 seconds #> Processing gene expression data (imputation, residualization) #> Task finished in 0.001 seconds #> Creating output file(s) #> Task finished in 0.004 seconds #> Performing eQTL analysis #> 100.00% done, 102 cis-eQTLs #> Task finished in 0.007 seconds #>  #> Success! Stats written to: ../inst/extdata/test_results/test_cis_qtl_stats.txt head(read.table(file_qtl, header = TRUE)) #>            phe_id var_id    z          pval #> 1     chr1_1_5000 snp_11  Inf 2.225074e-308 #> 2     chr1_1_5000 snp_13  Inf 2.225074e-308 #> 3     chr1_1_5000 snp_22 -Inf 2.225074e-308 #> 4     chr1_1_5000 snp_33  Inf 2.225074e-308 #> 5     chr1_1_5000 snp_44  Inf 2.225074e-308 #> 6 chr1_5001_10000 snp_11 -Inf 2.225074e-308"},{"path":"https://liliw-w.github.io/cacti/articles/cacti_s_prep.html","id":"part-3-run-multivariate-association-with-cacti","dir":"Articles","previous_headings":"","what":"Part 3: Run multivariate association with CACTI","title":"CACTI-S: segment-based data preparation & mapping","text":"files generated CACTI-S pipeline serve primary inputs core CACTI analysis. include phenotype metadata (file_pheno_meta), normalized phenotypes (file_pheno), covariates (file_cov), QTL summary statistics (file_qtl). details, please see vignette . inputs ready, can directly run cacti_run_chr() (single chromosome) cacti_run_genome() (whole genome). function returns list containing paths generated files: preview final association statistics:","code":"file_pheno <- \"../inst/extdata/test_results/test_pheno_norm.txt\" file_pheno_meta <- \"../inst/extdata/test_results/test_pheno_norm_meta.txt\" file_cov   <- \"../inst/extdata/test_cov.txt\" file_qtl <- \"../inst/extdata/test_results/test_cis_qtl_stats.txt\" out_prefix <- '../inst/extdata/test_results/cactis_chr1' chr <- \"chr1\"  res_single_chr <- cacti_run_chr(   window_size     = \"5kb\",   file_pheno_meta = file_pheno_meta,   file_pheno      = file_pheno,   file_cov        = file_cov,   chr             = chr,   qtl_file        = file_qtl,   out_prefix      = out_prefix,   min_peaks       = 2 ) #> ======================================================= #>  CACTI Pipeline #> ======================================================= #> Output Directory: ../inst/extdata/test_results #>  #> [Step 1/3] Group peaks into non-overlapping windows … #>  #> [Step 2/3] Residualize phenotype by covariates … #>  #> [Step 3/3] Run pvalue for chr1 … #>  #> ======================================================= #>  #>  CACTI pipeline for chr1 completed! #> ======================================================= #> ======================================================= #> ----------- Run summary ----------- #> Chromosome:chr1 #> Window size:5kb #>  #>  ----------- Input files ----------- #> Peaks BED:../inst/extdata/test_results/test_pheno_norm_meta.txt #> Phenotype:../inst/extdata/test_results/test_pheno_norm.txt #> Covariate:../inst/extdata/test_cov.txt #> QTL summary stats:../inst/extdata/test_results/test_cis_qtl_stats.txt #>  #>  ----------- Output files ----------- #>   [1] Grouped peak: ../inst/extdata/test_results/cactis_chr1_peak_group_window5kb.txt #>   [2] Grouped peak (peak as row):../inst/extdata/test_results/cactis_chr1_peak_group_window5kb_peak_as_row.txt #>   [3] Residual phenotype:../inst/extdata/test_results/cactis_chr1_pheno_cov_residual.txt #>   [4] Pval results (chr1): ../inst/extdata/test_results/cactis_chr1_pval_window5kb_chr1.txt.gz #> ======================================================= print(res_single_chr) #> $file_peak_group #> [1] \"../inst/extdata/test_results/cactis_chr1_peak_group_window5kb.txt\" #>  #> $file_peak_group_peaklevel #> [1] \"../inst/extdata/test_results/cactis_chr1_peak_group_window5kb_peak_as_row.txt\" #>  #> $file_pheno_cov_residual #> [1] \"../inst/extdata/test_results/cactis_chr1_pheno_cov_residual.txt\" #>  #> $file_p_peak_group #> [1] \"../inst/extdata/test_results/cactis_chr1_pval_window5kb_chr1.txt.gz\" head(read.table(res_single_chr$file_p_peak_group, header = TRUE)) #>   group    snp pval #> 1    G1 snp_11    0 #> 2    G1 snp_13    0 #> 3    G1 snp_22    0 #> 4    G1 snp_33    0 #> 5    G1 snp_44    0 #> 6    G1  snp_8    0"},{"path":"https://liliw-w.github.io/cacti/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Lili Wang. Author, maintainer.","code":""},{"path":"https://liliw-w.github.io/cacti/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang L (2026). cacti: CACTI: Chromatin QTL Mapping Peak Windows. R package version 0.0.0.9000, https://liliw-w.github.io/cacti, https://github.com/liliw-w/cacti.","code":"@Manual{,   title = {cacti: CACTI: Chromatin QTL Mapping with Peak Windows},   author = {Lili Wang},   year = {2026},   note = {R package version 0.0.0.9000, https://liliw-w.github.io/cacti},   url = {https://github.com/liliw-w/cacti}, }"},{"path":[]},{"path":"https://liliw-w.github.io/cacti/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"CACTI (ChromAtin quantitative loCi mulTIple peaks) implements powerful method chromatin QTL mapping leverages correlation structure nearby regulatory elements. package offers two main modules: CACTI (Peak-window method): Groups pre-defined peaks non-overlapping windows fixed genomic size. Residualizes peak intensities respect covariates. Runs multi-peak association tests using principal-component omnibus (PCO) test. Aggregates results computes window-level FDR. CACTI-S (Sample-based pipeline): end--end preprocessing workflow go raw BAM files normalized phenotype matrices QTL mapping. Performs segmentation, read counting, QC/filtering, normalization. Runs cis-QTL mapping generate input files CACTI.","code":""},{"path":"https://liliw-w.github.io/cacti/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"installation:","code":"install.packages(\"devtools\")   # if not installed yet devtools::install_github(\"liliw-w/cacti\", build_vignettes = TRUE) library(cacti)"},{"path":[]},{"path":"https://liliw-w.github.io/cacti/index.html","id":"vignettes","dir":"","previous_headings":"Documentation","what":"Vignettes","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"See full documentation vignettes - CACTI Peak-Window Pipeline CACTI-S Pipeline Vignettes can also viewed within installed package -","code":"vignette(\"cacti_peak_window\", package = \"cacti\") vignette(\"cacti_s_prep\", package = \"cacti\")"},{"path":"https://liliw-w.github.io/cacti/index.html","id":"main-functions-documentation","dir":"","previous_headings":"Documentation","what":"Main functions documentation","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"","code":"?cacti_run_chr ?cacti_run_genome ?cacti_add_fdr ?cacti_s_prep"},{"path":"https://liliw-w.github.io/cacti/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"CACTI: Leveraging Correlated Regulatory Elements for Powerful Chromatin QTL Detection","text":"use CACTI method, please cite: Wang, L., & Liu, X. (2025). Improved chromatin QTL mapping CACTI. bioRxiv, 2025-06.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti.html","id":null,"dir":"Reference","previous_headings":"","what":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","title":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","text":"cacti package implements CACTI peak-window method chromatin QTL mapping. designed :","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","text":"group nearby peaks non-overlapping genomic windows, residualize peak intensities respect covariates, run multi-peak association tests using principal-component omnibus (PCO) test, aggregate per-chromosome results compute window-level FDR. main user-facing functions : cacti_run_chr: run peak-window pipeline single chromosome. cacti_run_genome: run peak-window pipeline across multiple chromosomes add FDR. Lower-level building blocks: cacti_group_peak_window: group peaks non-overlapping windows. cacti_pheno_cov_residual: residualize phenotypes covariates. cacti_cal_p: run CACTI association tests peak windows. cacti_add_fdr: compute window-level FDR across chromosomes. small toy dataset Aracena et al. bundled inst/extdata/ can accessed using system.file testing examples. overview peak-window pipeline file formats, see package vignette: browseVignettes(\"cacti\")","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"CACTI: Chromatin QTL Mapping with Peak Windows — cacti","text":"Maintainer: Lili Wang liliw1@uchicago.edu","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":null,"dir":"Reference","previous_headings":"","what":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"Reads per-chromosome CACTI window result files, computes per-window top-hit summaries (min p, Bonferroni, ACAT across SNPs window), assigns q-values ACAT top-hit p-values.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"","code":"cacti_add_fdr(file_all_pval, file_fdr_out)"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"file_all_pval character vector containing pvalue file paths. e.g., \"c(chr1.txt.gz, chr2.txt.gz, chr3.txt.gz)\" file_fdr_out Output filename combined results FDR.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"Invisibly returns combined results FDR.; writes file_fdr_out.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_add_fdr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add FDR (q-values) to per-window top hits across chromosomes — cacti_add_fdr","text":"Expected columns file: group : window / peak-group ID snp   : variant ID pval : p-value per (snp, group)","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CACTI association test for a single chromosome — cacti_cal_p","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"Run CACTI association test single chromosome","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"","code":"cacti_cal_p(   file_qtl_cis_norm,   chr,   file_peak_group,   file_pheno_cov_residual,   file_p_peak_group,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2 )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"file_qtl_cis_norm Path cis QTL summary stats. Must contain columns: phe_id, var_id, z. chr Chromosome label (e.g., \"chr21\"). Used subset peak groups. file_peak_group Path peak-window metadata (groups) file. Produced step_group_peak_window. file_pheno_cov_residual Path residualized phenotype matrix file. Produced step_pheno_cov_residual. file_p_peak_group Output path per-window pvalues. Columns: group, snp, pval. dir_pco Directory containing association test helpers: ModifiedPCOMerged_acat.R, liu.R, liumod.R, davies.R, qfc.. min_peaks Minimum number peaks required group run multivariate PCO test (>= min_peaks -> PCO; < min_peaks -> univariate p).","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_cal_p.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CACTI association test for a single chromosome — cacti_cal_p","text":"Invisibly returns pvalue tibble; writes file_p_peak_group.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":null,"dir":"Reference","previous_headings":"","what":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"Group peaks non-overlapping genomic windows size window_size, using peak coordinates BED-like metadata table.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"","code":"cacti_group_peak_window(   window_size,   file_pheno_meta,   file_peak_group,   file_peak_group_peaklevel )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"window_size Character like \"50kb\" (kb units) numeric (bp). file_pheno_meta Path input phenotype meta table (header). Columns - phe_chr: chromosome, \"chr\" prefix (e.g. \"chr1\") phe_from: peak start (integer, < phe_to) phe_to: peak end (integer) phe_id: peak identifier (unique per row) file_peak_group Output path window-level table. Columns - group, group_chr, group_from, group_to, pid_group, n_pid_group file_peak_group_peaklevel Output path peak-level table. Columns - phe_id, phe_chr, phe_from, phe_to, group, n_pid_group","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_group_peak_window.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Group adjacent peaks by non-overlapping windows — cacti_group_peak_window","text":"Invisibly returns grouped window-level table; writes file_peak_group.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":null,"dir":"Reference","previous_headings":"","what":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"Reads phenotype matrix (features x samples; first column = feature ID) covariate matrix (covariates x samples; first column = covariate ID)","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"","code":"cacti_pheno_cov_residual(file_pheno, file_cov, file_pheno_cov_residual)"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"file_pheno Path phenotype expression matrix. Rows = features; first column = feature ID; remaining columns = samples. file_cov Path covariate matrix. Rows = covariates; first column = covariate ID; remaining columns = samples. file_pheno_cov_residual Output filename. Rows = features; first column = feature ID; remaining columns = samples.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_pheno_cov_residual.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Residualize peak intensity with covariates — cacti_pheno_cov_residual","text":"Invisibly returns residual matrix (features x samples); writes file_pheno_cov_residual.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"Steps: Group peaks non-overlapping windows. Residualize phenotype covariates. Run association test peak groups single chromosome.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"","code":"cacti_run_chr(   window_size,   file_pheno_meta,   file_pheno,   file_cov,   chr,   qtl_file,   out_prefix,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2 )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"window_size Character like \"50kb\" (kb units) numeric (bp). file_pheno_meta Path input phenotype meta table (header). Columns - phe_chr: chromosome, \"chr\" prefix (e.g. \"chr1\") phe_from: peak start (integer, < phe_to) phe_to: peak end (integer) phe_id: peak identifier (unique per row) file_pheno Path phenotype expression matrix. Rows = features; first column = feature ID; remaining columns = samples. file_cov Path covariate matrix. Rows = covariates; first column = covariate ID; remaining columns = samples. chr Chromosome label process (e.g., \"chr1\", \"chr21\"). qtl_file Path cis QTL summary stats file chromosome. Must contain columns: phe_id, var_id, z. out_prefix Output prefix used construct output filenames. dir_pco Directory containing association test helpers: ModifiedPCOMerged_acat.R, liu.R, liumod.R, davies.R, qfc.. min_peaks Minimum number peaks required window run multivariate PCO test (>= min_peaks -> PCO; < min_peaks -> univariate p).","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"Invisibly returns named list output paths elements: file_peak_group Path window-level group. file_peak_group_peaklevel Path peak-level group. file_pheno_residual Path residualized phenotype matrix. file_p_peak_group Path per-window p-value file chromosome.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_chr.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run CACTI peak-window pipeline for a single chromosome — cacti_run_chr","text":"","code":"if (FALSE) { # \\dontrun{ # Example (chr5 only)  file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  out_prefix <- tempfile(\"cacti_chr5_\")  res <- cacti_run_chr(   window_size = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno = file_pheno,   file_cov = file_cov,   chr = \"chr5\",   qtl_file = qtl_file,   out_prefix = out_prefix,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2 ) } # }"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"function convenience wrapper runs CACTI peak-window pipeline across multiple chromosomes computes window-level FDR across peak windows chromosomes.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"","code":"cacti_run_genome(   window_size,   file_pheno_meta,   file_pheno,   file_cov,   chrs,   qtl_files,   out_prefix,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2,   file_fdr_out = NULL )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"window_size Character like \"50kb\" (kb units) numeric (bp). file_pheno_meta Path input phenotype meta table (header). Columns - phe_chr: chromosome, \"chr\" prefix (e.g. \"chr1\") phe_from: peak start (integer, < phe_to) phe_to: peak end (integer) phe_id: peak identifier (unique per row) file_pheno Path phenotype expression matrix. Rows = features; first column = feature ID; remaining columns = samples. file_cov Path covariate matrix. Rows = covariates; first column = covariate ID; remaining columns = samples. chrs Character vector chromosome labels (e.g., paste0(\"chr\", 1:22)). qtl_files Either: character vector length chrs, giving cis-QTL file path chromosome order; single template string containing placeholder \"{chr}\", e.g., \"extdata/test_qtl_sum_stats_{chr}.txt.gz\". case, placeholder replaced element chrs. out_prefix Output prefix used construct output filenames. dir_pco Directory containing association test helpers: ModifiedPCOMerged_acat.R, liu.R, liumod.R, davies.R, qfc.. min_peaks Minimum number peaks required window run multivariate PCO test (>= min_peaks -> PCO; < min_peaks -> univariate p). file_fdr_out Optional output path FDR-added window-level file. NULL, default filename constructed out_prefix window_size.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"Invisibly returns named list output paths elements: file_peak_group Path window-level group. file_peak_group_peaklevel Path peak-level group. file_pheno_residual Path residualized phenotype matrix. file_p_peak_group Path per-window p-value file chromosome. file_fdr_out Path FDR-added window-level result file.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"chromosome chrs, calls cacti_run_chr() collects per-window p-value files. calls cacti_add_fdr() , aggregating chromosomes obtain q-values top-hit p-values window.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_run_genome.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run CACTI peak-window pipeline genome-wide and add FDR — cacti_run_genome","text":"","code":"if (FALSE) { # \\dontrun{ # Example (chr5 as all chr)  file_pheno_meta <- system.file(   \"extdata\", \"test_pheno_meta.bed\",   package = \"cacti\" )  file_pheno <- system.file(   \"extdata\", \"test_pheno.txt\",   package = \"cacti\" )  file_cov <- system.file(   \"extdata\", \"test_covariates.txt\",   package = \"cacti\" )  qtl_file <- system.file(   \"extdata\", \"test_qtl_sum_stats_chr5.txt.gz\",   package = \"cacti\" )  out_prefix <- tempfile(\"cacti_genome_\")  res <- cacti_run_genome(   window_size = \"50kb\",   file_pheno_meta = file_pheno_meta,   file_pheno = file_pheno,   file_cov = file_cov,   chrs = \"chr5\",   qtl_files = qtl_file,   out_prefix = out_prefix,   dir_pco = system.file(\"pco\", package = \"cacti\"),   min_peaks = 2,   file_fdr_out = file.path(tempdir(), \"cacti_fdr_chr5.txt.gz\") ) } # }"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_count.html","id":null,"dir":"Reference","previous_headings":"","what":"Count reads in genomic segments (CACTI-S) — cacti_s_count","title":"Count reads in genomic segments (CACTI-S) — cacti_s_count","text":"wrapper around Rsubread::featureCounts quantify reads SAF segments generated cacti_s_create_segments.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_count.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Count reads in genomic segments (CACTI-S) — cacti_s_count","text":"","code":"cacti_s_count(   file_bams,   file_saf,   file_counts_out,   threads = 1,   isPairedEnd = FALSE,   ... )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_count.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Count reads in genomic segments (CACTI-S) — cacti_s_count","text":"file_bams Character vector BAM file paths. file_saf Path SAF annotation file (cacti_s_create_segments). file_counts_out Output path counts matrix. threads Number threads featureCounts. isPairedEnd Logical. TRUE, fragments counted instead reads. Default FALSE. ... Additional arguments passed Rsubread::featureCounts.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_count.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Count reads in genomic segments (CACTI-S) — cacti_s_count","text":"Invisibly returns counts matrix; writes file_counts_out.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_count.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Count reads in genomic segments (CACTI-S) — cacti_s_count","text":"default, runs settings optimized CACTI-S: -F SAF: Uses SAF format provided. --read2pos 5: Reduces reads 5' end. --primary: Counts primary alignments. --ignoreDup: Ignores duplicate reads.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_count.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Count reads in genomic segments (CACTI-S) — cacti_s_count","text":"","code":"if (FALSE) { # \\dontrun{ # Locate test data bundled in the package file_saf <- system.file(\"extdata/test_results\", \"test_segments.saf\", package = \"cacti\") file_bam1 <- system.file(\"extdata\", \"Sample1.bam\", package = \"cacti\") file_bam2 <- system.file(\"extdata\", \"Sample2.bam\", package = \"cacti\") file_bam3 <- system.file(\"extdata\", \"Sample3.bam\", package = \"cacti\") file_bam4 <- system.file(\"extdata\", \"Sample4.bam\", package = \"cacti\")  # Define output file file_out <- \"inst/extdata/test_results/test_raw_counts.txt\"  # Run counting if (file.exists(file_bam1) && file.exists(file_saf)) {   cacti_s_count(     file_bams = c(file_bam1, file_bam2, file_bam3, file_bam4),     file_saf  = file_saf,     file_counts_out = file_out   )    # Check result   head(read.table(file_out, header = TRUE)) } } # }"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_create_segments.html","id":null,"dir":"Reference","previous_headings":"","what":"Create fixed-size genomic segments (SAF format) — cacti_s_create_segments","title":"Create fixed-size genomic segments (SAF format) — cacti_s_create_segments","text":"Splits autosomes (chr1-chr22) fixed-size segments writes SAF file compatible Rsubread::featureCounts.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_create_segments.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create fixed-size genomic segments (SAF format) — cacti_s_create_segments","text":"","code":"cacti_s_create_segments(   file_saf_out,   genome = c(\"hg19\", \"hg38\"),   segment_size = \"5kb\" )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_create_segments.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create fixed-size genomic segments (SAF format) — cacti_s_create_segments","text":"file_saf_out Output path SAF file. genome Genome build use: \"hg19\" (default) \"hg38\". segment_size Character like \"5kb\" numeric bp (e.g. 5000). Default \"5kb\".","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_create_segments.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create fixed-size genomic segments (SAF format) — cacti_s_create_segments","text":"Invisibly returns segment data frame. Writes file_saf_out disk.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_create_segments.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create fixed-size genomic segments (SAF format) — cacti_s_create_segments","text":"function uses built-chromosome sizes hg19 hg38. strictly filters genome include chromosomes named \"chr1\" \"chr22\". Sex chromosomes (chrX, chrY) mitochondrial DNA (chrM) excluded.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_create_segments.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create fixed-size genomic segments (SAF format) — cacti_s_create_segments","text":"","code":"if (FALSE) { # \\dontrun{ # Create 5kb segments for hg19 (default) cacti_s_create_segments(\"inst/extdata/test_results/test_segments.saf\")  # Create 1kb segments for hg38 cacti_s_create_segments(\"inst/extdata/test_results/test_segments.saf\", genome = \"hg38\", segment_size = \"1kb\") } # }"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_map_cis.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Nominal Cis-QTL Mapping (CACTI-S) — cacti_s_map_cis","title":"Run Nominal Cis-QTL Mapping (CACTI-S) — cacti_s_map_cis","text":"Performs linear regression using MatrixEQTL generate summary statistics.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_map_cis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Nominal Cis-QTL Mapping (CACTI-S) — cacti_s_map_cis","text":"","code":"cacti_s_map_cis(   file_pheno,   file_pheno_meta,   file_cov,   file_qtl_out,   file_vcf = NULL,   file_geno = NULL,   file_snp_pos = NULL,   cis_dist = 1e+05,   p_threshold = 1 )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_map_cis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Nominal Cis-QTL Mapping (CACTI-S) — cacti_s_map_cis","text":"file_pheno Path processed phenotype file position meta expression data (cacti_s_preprocess). file_pheno_meta Path meta file processed phenotype. file_cov Path covariate matrix. file_qtl_out Output path summary statistics. file_vcf Path input VCF file. file_geno (Optional) Path genotype matrix VCF. file_snp_pos (Optional) Path SNP positions VCF. cis_dist Cis-window distance (default 100000 bp = 100kb). p_threshold P-value threshold output (default 1.0, print associations).","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_map_cis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run Nominal Cis-QTL Mapping (CACTI-S) — cacti_s_map_cis","text":"Invisibly returns summary stats.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_map_cis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Nominal Cis-QTL Mapping (CACTI-S) — cacti_s_map_cis","text":"","code":"if (FALSE) { # \\dontrun{ # Use local paths for testing file_pheno <- \"inst/extdata/test_results/test_pheno_norm.txt\" file_pheno_meta <- \"inst/extdata/test_results/test_pheno_norm_meta.txt\" file_cov   <- \"inst/extdata/test_cov.txt\" file_vcf   <- \"inst/extdata/test_geno.vcf\"  file_out <- \"inst/extdata/test_results/test_cis_qtl_stats.txt\"  # Run if (file.exists(file_pheno) && file.exists(file_vcf)) {   cacti_s_map_cis(     file_pheno   = file_pheno,     file_pheno_meta = file_pheno_meta,     file_cov     = file_cov,     file_vcf     = file_vcf,     file_qtl_out = file_out,     cis_dist     = 100000   ) } } # }"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_prep.html","id":null,"dir":"Reference","previous_headings":"","what":"Run CACTI-S Prep Pipeline — cacti_s_prep","title":"Run CACTI-S Prep Pipeline — cacti_s_prep","text":"master wrapper function executes full CACTI-S preparation pipeline. automates transition raw BAM files normalized phenotype matrix optionally performs nominal cis-QTL mapping.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_prep.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run CACTI-S Prep Pipeline — cacti_s_prep","text":"","code":"cacti_s_prep(   file_bams,   file_vcf = NULL,   file_cov = NULL,   out_dir,   out_prefix = \"cacti_s\",   file_saf_custom = NULL,   genome = \"hg19\",   segment_size = \"5kb\",   filter_mode = \"cpm_threshold\",   filter_bed = NULL,   min_cpm = 1,   min_prop = 0.2,   prop_top = 0.2,   cis_dist = 1e+05,   threads = 1,   isPairedEnd = FALSE )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_prep.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run CACTI-S Prep Pipeline — cacti_s_prep","text":"file_bams Character vector file paths input BAM files. sorted indexed. file_vcf (Optional) Path input VCF file containing genotype data. Required want run mapping step. file_cov (Optional) Path covariate matrix file. Format: Rows covariates (ID, S1, S2...), Columns samples. Required file_vcf provided. out_dir Directory path output files saved. Created automatically exist. out_prefix String prefix generated filenames (default \"cacti_s\"). Files created: _segments.saf, _raw_counts.txt, _pheno_norm.txt, _cis_qtl_stats.txt, etc. file_saf_custom (Optional) Path existing SAF file. provided, segment generation skipped. genome Genome build use segment generation. Options: \"hg19\" (default) \"hg38\". segment_size String defining window size tiling genome (e.g., \"1kb\", \"5kb\", \"10kb\"). Default \"5kb\". filter_mode Strategy selecting informative segments preprocessing: \"cpm_threshold\" (Default): Keeps segments Counts Per Million (CPM) > min_cpm least min_prop proportion samples. \"match_overlap_count\": Calculates $N$, number segments physically overlap regions filter_bed. selects top $N$ segments based average CPM intensity. \"prop\": Simply keeps top prop_top proportion segments ranked average CPM. filter_bed (Required match_overlap_count) Path BED file (e.g., ATAC-seq peaks, H3K27ac peaks, known QTL regions) used determine number segments keep. min_cpm (cpm_threshold) Minimum CPM intensity threshold. Default 1. min_prop (cpm_threshold) Minimum proportion samples (0-1) must exceed min_cpm. Default 0.2. prop_top (prop) Proportion (0-1) top-expressed segments keep. Default 0.2. cis_dist (Mapping) maximum distance (bp) gene (segment) SNP considered \"cis\". Default 100,000 bp. threads Integer, number threads use read counting step. Default 1. isPairedEnd Logical, indicating BAM files contain paired-end reads. Default FALSE.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_prep.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run CACTI-S Prep Pipeline — cacti_s_prep","text":"Invisibly returns list containing paths generated files: segments.saf: Path segment definition file. raw_counts.txt: Path featureCounts output. pheno_norm.txt: Path final normalized phenotype matrix. cis_qtl_stats.txt: (mapped) Path cis-QTL summary statistics.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_prep.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run CACTI-S Prep Pipeline — cacti_s_prep","text":"Pipeline Stages: Create Segments: Generates fixed-size genomic windows (SAF) specified genome build. Count Reads: Quantifies reads segments using Rsubread::featureCounts. Preprocess: Performs QC (removing zero-count segments), Normalization (CPM), Filtering (different modes), Standardization (Z-score), Rank Normalization (INT). Map Cis-QTLs: (Optional) Runs linear regression using MatrixEQTL VCF Covariates provided.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_prep.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run CACTI-S Prep Pipeline — cacti_s_prep","text":"","code":"if (FALSE) { # \\dontrun{ # Locate test data bundled with the package file_bam1 <- system.file(\"extdata\", \"Sample1.bam\", package = \"cacti\") file_bam2 <- system.file(\"extdata\", \"Sample2.bam\", package = \"cacti\") file_bam3 <- system.file(\"extdata\", \"Sample3.bam\", package = \"cacti\") file_bam4 <- system.file(\"extdata\", \"Sample4.bam\", package = \"cacti\") file_vcf  <- system.file(\"extdata\", \"test_geno.vcf\", package = \"cacti\") file_cov  <- system.file(\"extdata\", \"test_cov.txt\", package = \"cacti\")  # Create a temporary output directory out_dir <- \"inst/extdata/test_results\"  if (nchar(file_bam1) > 0) {   # --- Run Full Pipeline (BAM -> QTL Stats) ---   res <- cacti_s_prep(     file_bams = c(file_bam1, file_bam2, file_bam3, file_bam4),     file_vcf = file_vcf,     file_cov = file_cov,      out_dir = out_dir,     out_prefix = \"test\",      # Segment Parameters     file_saf_custom = NULL,     genome = \"hg19\",     segment_size = \"5kb\",      # Filtering Parameters     filter_mode = \"cpm_threshold\",     min_cpm = 1,     min_prop = 0.2,      # Execution Parameters     threads = 1   ) } } # }"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_preprocess.html","id":null,"dir":"Reference","previous_headings":"","what":"Preprocess CACTI-S Segments — cacti_s_preprocess","title":"Preprocess CACTI-S Segments — cacti_s_preprocess","text":"Performs QC, filtering, normalization","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_preprocess.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Preprocess CACTI-S Segments — cacti_s_preprocess","text":"","code":"cacti_s_preprocess(   file_raw_counts,   file_out,   file_out_meta,   filter_mode = c(\"cpm_threshold\", \"match_overlap_count\", \"prop\"),   filter_bed = NULL,   prop_top = 0.2,   min_cpm = 1,   min_prop = 0.2 )"},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_preprocess.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Preprocess CACTI-S Segments — cacti_s_preprocess","text":"file_raw_counts Path featureCounts output (cacti_s_count). file_out Output path processed phenotype file. file_out_meta Output path meta file processed phenotype. filter_mode Strategy select segments: \"cpm_threshold\" (default), \"match_overlap_count\", \"prop\". filter_bed (Required \"match_overlap_count\") Path BED file (e.g. peaks QTL regions). prop_top (\"prop\") Proportion segments keep (0.0 1.0). Default 0.2. min_cpm (\"cpm_threshold\") Minimum CPM threshold (default 1). min_prop (\"cpm_threshold\") Minimum proportion samples (default 0.2).","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_preprocess.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Preprocess CACTI-S Segments — cacti_s_preprocess","text":"Invisibly returns processed data frame. Writes file_out disk.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_preprocess.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Preprocess CACTI-S Segments — cacti_s_preprocess","text":"Processing Steps: QC: Remove segments 0 reads samples. CPM: Transform counts log2(CPM + 0.5). Filter: Subset segments based filter_mode. Standardize: Z-score normalization per feature (Mean=0, SD=1). RankNorm: Inverse Normal Transform per sample. Filtering Logic: cpm_threshold (Default): Keeps segments peak intensity > min_cpm > min_prop samples. Standard method remove noise. match_overlap_count: Determines $N$, number segments overlapping regions filter_bed. keeps top $N$ segments average intensity. prop: Keeps top prop_top proportion segments average intensity.","code":""},{"path":"https://liliw-w.github.io/cacti/reference/cacti_s_preprocess.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Preprocess CACTI-S Segments — cacti_s_preprocess","text":"","code":"if (FALSE) { # \\dontrun{ # Locate the bundled test data filecounts <- system.file(\"extdata/test_results\", \"test_raw_counts.txt\", package = \"cacti\") filepeaks  <- system.file(\"extdata\", \"test_peaks.bed\", package = \"cacti\")  # Define output file fileout <- \"inst/extdata/test_results/test_pheno_norm.txt\" fileout <- \"inst/extdata/test_results/test_pheno_norm_meta.txt\"  # Check if files exist (only true if package is installed) if (nchar(filecounts) > 0) {    # --- Example 1: Default Filtering (CPM Threshold) ---   cacti_s_preprocess(     file_raw_counts = filecounts,     file_out = fileout,     file_out_meta = fileout_meta,     filter_mode = \"cpm_threshold\",     min_cpm = 10,     min_prop = 0.5   )   head(read.table(fileout, header = TRUE))    # --- Example 2: Match Overlap Count ---   # Logic: If 2 segments overlap peaks, keep the top 2 segments by intensity.   cacti_s_preprocess(     file_raw_counts = filecounts,     file_out = fileout,     file_out_meta = fileout_meta,     filter_mode = \"match_overlap_count\",     filter_bed = filepeaks   )   head(read.table(fileout, header = TRUE)) } } # }"}]
